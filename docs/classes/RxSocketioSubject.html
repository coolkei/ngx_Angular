<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>ngx-starter-kit documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">ngx-starter-kit documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>
            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">











<ol class="breadcrumb">
  <li>Classes</li>
  <li>RxSocketioSubject</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>libs/socketio-plugin/src/lib/RxSocketioSubject.ts</code>
        </p>


            <p class="comment">
                <h3>Extends</h3>
            </p>
            <p class="comment">
                    <code><a href="../classes/Subject.html" target="_self" >AnonymousSubject</a></code>
            </p>



            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#_config">_config</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#_output">_output</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#_socket">_socket</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#_subscribe">_subscribe</a>
                            </li>
                            <li>
                                <a href="#complete">complete</a>
                            </li>
                            <li>
                                <a href="#error">error</a>
                            </li>
                            <li>
                                <a href="#next">next</a>
                            </li>
                            <li>
                                <a href="#unsubscribe">unsubscribe</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(urlConfigOrSource: <a href="../interfaces/RxSocketioSubjectConfig.html">string | RxSocketioSubjectConfig<T> | Observable<T></a>, destination?: Observer<T>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="65" class="link-to-prism">libs/socketio-plugin/src/lib/RxSocketioSubject.ts:65</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>urlConfigOrSource</td>
                                                  
                                                        <td>
                                                                    <code><a href="../interfaces/RxSocketioSubjectConfig.html" target="_self" >string | RxSocketioSubjectConfig&lt;T&gt; | Observable&lt;T&gt;</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>destination</td>
                                                  
                                                        <td>
                                                                    <code>Observer&lt;T&gt;</code>
                                                        </td>
                                                  
                                                    <td>
                                                            Yes
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="_config"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Private</span>
                            _config
                            </b>
                            <a href="#_config"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span><code>_config:     <code><a href="../interfaces/RxSocketioSubjectConfig.html" target="_self" >RxSocketioSubjectConfig&lt;T&gt;</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="../interfaces/RxSocketioSubjectConfig.html" target="_self" >RxSocketioSubjectConfig&lt;T&gt;</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="64" class="link-to-prism">libs/socketio-plugin/src/lib/RxSocketioSubject.ts:64</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="_output"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Private</span>
                            _output
                            </b>
                            <a href="#_output"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span><code>_output:     <code><a href="../classes/Subject.html" target="_self" >Subject&lt;T&gt;</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="../classes/Subject.html" target="_self" >Subject&lt;T&gt;</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="63" class="link-to-prism">libs/socketio-plugin/src/lib/RxSocketioSubject.ts:63</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="_socket"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Private</span>
                            _socket
                            </b>
                            <a href="#_socket"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span><code>_socket:     <code>SocketIOClient.Socket</code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>SocketIOClient.Socket</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="65" class="link-to-prism">libs/socketio-plugin/src/lib/RxSocketioSubject.ts:65</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
</section>

            <section>
    
        <h3 id="methods">
            Methods
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="_subscribe"></a>
                        <span class="name">
                            <b>
                            _subscribe
                            </b>
                            <a href="#_subscribe"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>_subscribe(subscriber: Subscriber<T>)</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="141" class="link-to-prism">libs/socketio-plugin/src/lib/RxSocketioSubject.ts:141</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">

                            <div class="io-description">
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>subscriber</td>
                                                        <td>
                                                                    <code>Subscriber&lt;T&gt;</code>
                                                        </td>
                                                    
                                                    <td>
                                                            No
                                                    </td>
                                                    

                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code>Subscription</code>

                            </div>
                                <div class="io-description">
                                    
                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="complete"></a>
                        <span class="name">
                            <b>
                            complete
                            </b>
                            <a href="#complete"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>complete()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="137" class="link-to-prism">libs/socketio-plugin/src/lib/RxSocketioSubject.ts:137</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="error"></a>
                        <span class="name">
                            <b>
                            error
                            </b>
                            <a href="#error"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>error(err?: )</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="133" class="link-to-prism">libs/socketio-plugin/src/lib/RxSocketioSubject.ts:133</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">

                            <div class="io-description">
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>err</td>
                                                    
                                                    <td>
                                                            Yes
                                                    </td>
                                                    

                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                                <div class="io-description">
                                    
                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="next"></a>
                        <span class="name">
                            <b>
                            next
                            </b>
                            <a href="#next"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>next(value?: T)</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="129" class="link-to-prism">libs/socketio-plugin/src/lib/RxSocketioSubject.ts:129</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">

                            <div class="io-description">
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>value</td>
                                                        <td>
                                                                    <code>T</code>
                                                        </td>
                                                    
                                                    <td>
                                                            Yes
                                                    </td>
                                                    

                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                                <div class="io-description">
                                    
                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="unsubscribe"></a>
                        <span class="name">
                            <b>
                            unsubscribe
                            </b>
                            <a href="#unsubscribe"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>unsubscribe()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="147" class="link-to-prism">libs/socketio-plugin/src/lib/RxSocketioSubject.ts:147</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>






    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { NextObserver, Observable, Observer, Subscriber, Subscription } from &#x27;rxjs&#x27;;
import { AnonymousSubject } from &#x27;rxjs/internal/Subject&#x27;;
import * as io from &#x27;socket.io-client&#x27;;
import ConnectOpts &#x3D; SocketIOClient.ConnectOpts;
import { Subject } from &#x27;rxjs&#x27;;
import { ReplaySubject } from &#x27;rxjs/src/internal/ReplaySubject&#x27;;

// TODO https://github.com/arjitkhullar/ocr/blob/master/src/app/socket.service.ts

export interface RxSocketioSubjectConfig&lt;T&gt; {
  /** The url of the socket server to connect to */
  url: string;
  /** connect options for Socket.io */
  connectOpts?: ConnectOpts;
  /** auth token access callback function */
  tokenFn?: () &#x3D;&gt; string;
  /** The protocol to use to connect */
  protocol?: string | Array&lt;string&gt;;
  /** @deprecated use {@link deserializer} */
  resultSelector?: (e: MessageEvent) &#x3D;&gt; T;
  /**
   * A serializer used to create messages from passed values before the
   * messages are sent to the server. Defaults to JSON.stringify.
   */
  serializer?: (value: T) &#x3D;&gt; WebSocketMessage;
  /**
   * A deserializer used for messages arriving on the socket from the
   * server. Defaults to JSON.parse.
   */
  deserializer?: (e: MessageEvent) &#x3D;&gt; T;
  /**
   * An Observer that watches when open events occur on the underlying web socket.
   */
  openObserver?: NextObserver&lt;Event&gt;;
  /**
   * An Observer than watches when close events occur on the underlying webSocket
   */
  closeObserver?: NextObserver&lt;CloseEvent&gt;;
  /**
   * An Observer that watches when a close is about to occur due to
   * unsubscription.
   */
  closingObserver?: NextObserver&lt;void&gt;;
  /**
   * A WebSocket constructor to use. This is useful for situations like using a
   * WebSocket impl in Node (WebSocket is a DOM API), or for mocking a WebSocket
   * for testing purposes
   */
  WebSocketCtor?: { new (url: string, protocols?: string | string[]): WebSocket };
  /** Sets the &#x60;binaryType&#x60; property of the underlying WebSocket. */
  binaryType?: &#x27;blob&#x27; | &#x27;arraybuffer&#x27;;
}

const DEFAULT_WEBSOCKET_CONFIG: RxSocketioSubjectConfig&lt;any&gt; &#x3D; {
  url: &#x27;&#x27;,
  deserializer: (e: MessageEvent) &#x3D;&gt; JSON.parse(e.data),
  serializer: (value: any) &#x3D;&gt; JSON.stringify(value),
};

export type WebSocketMessage &#x3D; string | ArrayBuffer | Blob | ArrayBufferView;

export class RxSocketioSubject&lt;T&gt; extends AnonymousSubject&lt;T&gt; {
  private _output: Subject&lt;T&gt;;
  private _config: RxSocketioSubjectConfig&lt;T&gt;;
  private _socket: SocketIOClient.Socket;

  constructor(urlConfigOrSource: string | RxSocketioSubjectConfig&lt;T&gt; | Observable&lt;T&gt;, destination?: Observer&lt;T&gt;) {
    super();

    const config &#x3D; (this._config &#x3D; { ...DEFAULT_WEBSOCKET_CONFIG });

    if (typeof urlConfigOrSource &#x3D;&#x3D;&#x3D; &#x27;string&#x27;) {
      config.url &#x3D; urlConfigOrSource;
    } else {
      for (const key in urlConfigOrSource) {
        if (urlConfigOrSource.hasOwnProperty(key)) {
          config[key] &#x3D; urlConfigOrSource[key];
        }
      }
    }

    if (config.tokenFn &amp;&amp; typeof config.tokenFn &#x3D;&#x3D;&#x3D; &#x27;function&#x27;) {
      if (!config.connectOpts) {
        config.connectOpts &#x3D; { query: {} };
      }
      (config.connectOpts.query as any).token &#x3D; config.tokenFn();
    }

    this._output &#x3D; new Subject&lt;T&gt;();

    this._socket &#x3D; config.connectOpts ? io(config.url, config.connectOpts) : io(config.url);

    this._socket.on(&#x27;connect&#x27;, event &#x3D;&gt; config.openObserver.next(event));

    this._socket.on(&#x27;disconnect&#x27;, event &#x3D;&gt; config.closeObserver.next(event));

    this._socket.on(&#x27;actions&#x27;, data &#x3D;&gt; this._output.next(data));

    this._socket.on(&#x27;reconnect_attempt&#x27;, () &#x3D;&gt; {
      if (config.tokenFn &amp;&amp; typeof config.tokenFn &#x3D;&#x3D;&#x3D; &#x27;function&#x27;) {
        (this._socket.io.opts.query as any).token &#x3D; config.tokenFn();
      }
    });

    this.destination &#x3D; Subscriber.create(
      (message: T) &#x3D;&gt; {
        this._socket.emit((message as any).event, (message as any).data);
      },
      error &#x3D;&gt; {
        this._socket.close();
        const errorEvent &#x3D; new ErrorEvent(&#x27;&#x27;, {
          message: &#x27;Error in data stream.&#x27;,
          error: error,
        });
        super.error.call(this, errorEvent);
      },
      () &#x3D;&gt; {
        this._socket.close();
        const closeEvent &#x3D; new CloseEvent(&#x27;cloased&#x27;, {
          code: 1000,
          reason: &#x27;Connection closed by client.&#x27;,
          wasClean: true,
        });
        config.closeObserver.next(closeEvent);
      },
    );
  }

  next(value?: T) {
    this.destination.next.call(this.destination, value);
  }

  error(err?) {
    this.destination.error.call(this.destination, err);
  }

  complete() {
    this.destination.complete.call(this.destination);
  }

  _subscribe(subscriber: Subscriber&lt;T&gt;): Subscription {
    const subscription &#x3D; new Subscription();
    subscription.add(this._output.subscribe(subscriber));
    return subscription;
  }

  unsubscribe() {
    // tslint:disable
    super.unsubscribe();
  }
}
</code></pre>
    </div>
</div>







                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'RxSocketioSubject.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <script src="../js/menu-wc.js"></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
