<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>ngx-starter-kit documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">ngx-starter-kit documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li>RxSocketioSubjectConfig</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>libs/socketio-plugin/src/lib/RxSocketioSubject.ts</code>
        </p>



        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#binaryType">binaryType</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#closeObserver">closeObserver</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#closingObserver">closingObserver</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#connectOpts">connectOpts</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#deserializer">deserializer</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#openObserver">openObserver</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#protocol">protocol</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#resultSelector">resultSelector</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#serializer">serializer</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#tokenFn">tokenFn</a>
                                </li>
                                <li>
                                        <a href="#url">url</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#WebSocketCtor">WebSocketCtor</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="binaryType"></a>
                                        <span class="name"><b>binaryType</b><a href="#binaryType"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>binaryType:     <code>&quot;blob&quot; | &quot;arraybuffer&quot;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>&quot;blob&quot; | &quot;arraybuffer&quot;</code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Sets the <code>binaryType</code> property of the underlying WebSocket. </p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="closeObserver"></a>
                                        <span class="name"><b>closeObserver</b><a href="#closeObserver"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>closeObserver:     <code>NextObserver&lt;CloseEvent&gt;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>NextObserver&lt;CloseEvent&gt;</code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>An Observer than watches when close events occur on the underlying webSocket</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="closingObserver"></a>
                                        <span class="name"><b>closingObserver</b><a href="#closingObserver"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>closingObserver:     <code>NextObserver&lt;void&gt;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>NextObserver&lt;void&gt;</code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>An Observer that watches when a close is about to occur due to
unsubscription.</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="connectOpts"></a>
                                        <span class="name"><b>connectOpts</b><a href="#connectOpts"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>connectOpts:     <code>ConnectOpts</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>ConnectOpts</code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>connect options for Socket.io </p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="deserializer"></a>
                                        <span class="name"><b>deserializer</b><a href="#deserializer"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>deserializer:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank" >function</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank" >function</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>A deserializer used for messages arriving on the socket from the
server. Defaults to JSON.parse.</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="openObserver"></a>
                                        <span class="name"><b>openObserver</b><a href="#openObserver"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>openObserver:     <code>NextObserver&lt;Event&gt;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>NextObserver&lt;Event&gt;</code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>An Observer that watches when open events occur on the underlying web socket.</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="protocol"></a>
                                        <span class="name"><b>protocol</b><a href="#protocol"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>protocol:     <code>string | Array&lt;string&gt;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>string | Array&lt;string&gt;</code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>The protocol to use to connect </p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="resultSelector"></a>
                                        <span class="name"><b>resultSelector</b><a href="#resultSelector"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>resultSelector:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank" >function</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank" >function</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="serializer"></a>
                                        <span class="name"><b>serializer</b><a href="#serializer"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>serializer:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank" >function</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank" >function</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>A serializer used to create messages from passed values before the
messages are sent to the server. Defaults to JSON.stringify.</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="tokenFn"></a>
                                        <span class="name"><b>tokenFn</b><a href="#tokenFn"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>tokenFn:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank" >function</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank" >function</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>auth token access callback function </p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="url"></a>
                                        <span class="name"><b>url</b><a href="#url"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>url:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>The url of the socket server to connect to </p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="WebSocketCtor"></a>
                                        <span class="name"><b>WebSocketCtor</b><a href="#WebSocketCtor"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>WebSocketCtor:     <code>literal type</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>literal type</code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>A WebSocket constructor to use. This is useful for situations like using a
WebSocket impl in Node (WebSocket is a DOM API), or for mocking a WebSocket
for testing purposes</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { NextObserver, Observable, Observer, Subscriber, Subscription, Subject } from &#x27;rxjs&#x27;;
import { AnonymousSubject } from &#x27;rxjs/internal/Subject&#x27;;
import * as io from &#x27;socket.io-client&#x27;;
import ConnectOpts &#x3D; SocketIOClient.ConnectOpts;

// TODO https://github.com/arjitkhullar/ocr/blob/master/src/app/socket.service.ts

export interface RxSocketioSubjectConfig&lt;T&gt; {
  /** The url of the socket server to connect to */
  url: string;
  /** connect options for Socket.io */
  connectOpts?: ConnectOpts;
  /** auth token access callback function */
  tokenFn?: () &#x3D;&gt; string;
  /** The protocol to use to connect */
  protocol?: string | Array&lt;string&gt;;
  /** @deprecated use {@link deserializer} */
  resultSelector?: (e: MessageEvent) &#x3D;&gt; T;
  /**
   * A serializer used to create messages from passed values before the
   * messages are sent to the server. Defaults to JSON.stringify.
   */
  serializer?: (value: T) &#x3D;&gt; WebSocketMessage;
  /**
   * A deserializer used for messages arriving on the socket from the
   * server. Defaults to JSON.parse.
   */
  deserializer?: (e: MessageEvent) &#x3D;&gt; T;
  /**
   * An Observer that watches when open events occur on the underlying web socket.
   */
  openObserver?: NextObserver&lt;Event&gt;;
  /**
   * An Observer than watches when close events occur on the underlying webSocket
   */
  closeObserver?: NextObserver&lt;CloseEvent&gt;;
  /**
   * An Observer that watches when a close is about to occur due to
   * unsubscription.
   */
  closingObserver?: NextObserver&lt;void&gt;;
  /**
   * A WebSocket constructor to use. This is useful for situations like using a
   * WebSocket impl in Node (WebSocket is a DOM API), or for mocking a WebSocket
   * for testing purposes
   */
  WebSocketCtor?: { new (url: string, protocols?: string | string[]): WebSocket };
  /** Sets the &#x60;binaryType&#x60; property of the underlying WebSocket. */
  binaryType?: &#x27;blob&#x27; | &#x27;arraybuffer&#x27;;
}

const DEFAULT_WEBSOCKET_CONFIG: RxSocketioSubjectConfig&lt;any&gt; &#x3D; {
  url: &#x27;&#x27;,
  deserializer: (e: MessageEvent) &#x3D;&gt; JSON.parse(e.data),
  serializer: (value: any) &#x3D;&gt; JSON.stringify(value),
};

export type WebSocketMessage &#x3D; string | ArrayBuffer | Blob | ArrayBufferView;

export class RxSocketioSubject&lt;T&gt; extends AnonymousSubject&lt;T&gt; {
  private _output: Subject&lt;T&gt;;
  private _config: RxSocketioSubjectConfig&lt;T&gt;;
  private _socket: SocketIOClient.Socket;

  constructor(urlConfigOrSource: string | RxSocketioSubjectConfig&lt;T&gt; | Observable&lt;T&gt;, destination?: Observer&lt;T&gt;) {
    super();

    const config &#x3D; (this._config &#x3D; { ...DEFAULT_WEBSOCKET_CONFIG });

    if (typeof urlConfigOrSource &#x3D;&#x3D;&#x3D; &#x27;string&#x27;) {
      config.url &#x3D; urlConfigOrSource;
    } else {
      for (const key in urlConfigOrSource) {
        if (urlConfigOrSource.hasOwnProperty(key)) {
          config[key] &#x3D; urlConfigOrSource[key];
        }
      }
    }

    if (config.tokenFn &amp;&amp; typeof config.tokenFn &#x3D;&#x3D;&#x3D; &#x27;function&#x27;) {
      if (!config.connectOpts) {
        config.connectOpts &#x3D; { query: {} };
      }
      (config.connectOpts.query as any).token &#x3D; config.tokenFn();
    }

    this._output &#x3D; new Subject&lt;T&gt;();

    this._socket &#x3D; config.connectOpts ? io(config.url, config.connectOpts) : io(config.url);

    this._socket.on(&#x27;connect&#x27;, event &#x3D;&gt; config.openObserver.next(event));

    this._socket.on(&#x27;disconnect&#x27;, event &#x3D;&gt; config.closeObserver.next(event));

    this._socket.on(&#x27;actions&#x27;, data &#x3D;&gt; this._output.next(data));

    this._socket.on(&#x27;reconnect_attempt&#x27;, () &#x3D;&gt; {
      if (config.tokenFn &amp;&amp; typeof config.tokenFn &#x3D;&#x3D;&#x3D; &#x27;function&#x27;) {
        (this._socket.io.opts.query as any).token &#x3D; config.tokenFn();
      }
    });

    this.destination &#x3D; Subscriber.create(
      (message: T) &#x3D;&gt; {
        this._socket.emit((message as any).event, (message as any).data);
      },
      error &#x3D;&gt; {
        this._socket.close();
        const errorEvent &#x3D; new ErrorEvent(&#x27;&#x27;, {
          message: &#x27;Error in data stream.&#x27;,
          error: error,
        });
        super.error.call(this, errorEvent);
      },
      () &#x3D;&gt; {
        this._socket.close();
        const closeEvent &#x3D; new CloseEvent(&#x27;cloased&#x27;, {
          code: 1000,
          reason: &#x27;Connection closed by client.&#x27;,
          wasClean: true,
        });
        config.closeObserver.next(closeEvent);
      },
    );
  }

  next(value?: T) {
    this.destination.next.call(this.destination, value);
  }

  error(err?) {
    this.destination.error.call(this.destination, err);
  }

  complete() {
    this.destination.complete.call(this.destination);
  }

  _subscribe(subscriber: Subscriber&lt;T&gt;): Subscription {
    const subscription &#x3D; new Subscription();
    subscription.add(this._output.subscribe(subscriber));
    return subscription;
  }

  unsubscribe() {
    // tslint:disable
    super.unsubscribe();
  }
}
</code></pre>
    </div>
</div>






                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'RxSocketioSubjectConfig.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
